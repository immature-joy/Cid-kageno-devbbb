<!DOCTYPE html>
<html lang="en" class="bg-white text-black dark:bg-black dark:text-white">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Shadow bot | Cid Kageno</title>

<!-- Tailwind CSS -->
<script src="https://cdn.tailwindcss.com"></script>
<script>
tailwind.config = { darkMode: 'media', theme: { extend: {} } };
</script>

<!-- Feather Icons -->
<script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>

<style>
body { margin:0; font-family:sans-serif; }
.glass {
  backdrop-filter: blur(15px) saturate(180%);
  background-color: rgba(255,255,255,0.3);
  border-radius: 16px;
  box-shadow: 0 8px 32px rgba(0,0,0,0.1);
}
.dark .glass {
  background-color: rgba(0,0,0,0.3);
  box-shadow: 0 8px 32px rgba(0,0,0,0.2);
}

/* Typing dots */
.dot-flashing {
  width: 8px; height: 8px; border-radius: 50%;
  background-color: #999;
  animation: dotFlashing 1s infinite linear alternate;
}
@keyframes dotFlashing {
  0%{background-color:#999}50%,100%{background-color:transparent}
}

/* Fade-in for messages */
.animate-fadeIn { animation: fadeIn 0.3s ease forwards; }
@keyframes fadeIn {
  0%{opacity:0;transform:translateY(5px);} 
  100%{opacity:1;transform:translateY(0);}
}

/* Scrollbar */
#chat-container::-webkit-scrollbar { width:6px; }
#chat-container::-webkit-scrollbar-thumb { background-color: rgba(0,0,0,0.2); border-radius:3px; }

input:focus { outline:none; border-color:rgba(0,0,0,0.3); box-shadow:0 0 4px rgba(0,0,0,0.2); }
.dark input:focus { border-color:rgba(255,255,255,0.3); box-shadow:0 0 4px rgba(255,255,255,0.2); }
</style>
</head>

<body class="flex flex-col min-h-screen">

<!-- Header -->
<header class="p-4 text-center text-2xl font-bold glass mx-4 mt-4">ShadowGPT Portal</header>

<!-- Chat Container -->
<main class="flex-1 container mx-auto px-4 py-4 flex flex-col">
  <div id="chat-container" class="flex-1 mb-4 overflow-y-auto space-y-4 p-4 glass">
    <div class="flex justify-start">
      <div class="bg-gray-200/30 dark:bg-gray-700/30 rounded-xl p-4 max-w-xs md:max-w-md">
        <p class="text-sm text-black dark:text-white">Greetings, shadow walker. What knowledge do you seek from the void?</p>
      </div>
    </div>
  </div>

  <!-- Input Bar -->
  <div class="flex gap-2 glass p-4 rounded-xl">
    <input type="text" id="user-input" placeholder="Type your message..."
      class="flex-1 px-4 py-3 bg-transparent border border-gray-300 dark:border-gray-600 rounded-xl focus:ring-2 focus:ring-gray-400 dark:focus:ring-gray-500 text-black dark:text-white placeholder-black/50 dark:placeholder-white/50">
    <button id="send-btn" class="px-6 py-3 bg-gray-300/30 dark:bg-gray-600/30 hover:bg-gray-400/40 dark:hover:bg-gray-500/40 rounded-xl font-medium flex items-center gap-2 focus:outline-none focus:ring-2 focus:ring-gray-400 dark:focus:ring-gray-500">
      <i data-feather="send"></i>
      <span>Send</span>
    </button>
  </div>
</main>

<!-- Footer -->
<footer class="text-center p-4 text-sm opacity-60 glass mx-4 mb-4 rounded-xl">
  Â© All rights reserved by Cid Kageno
</footer>

<script>
feather.replace();

const chatContainer = document.getElementById('chat-container');
const userInput = document.getElementById('user-input');
const sendBtn = document.getElementById('send-btn');
const API_URL = "https://noobs-api.top/dipto/baby";

// Query AI
async function queryAI(message, userID="user123") {
  try {
    const res = await fetch(`${API_URL}?text=${encodeURIComponent(message)}&senderID=${userID}`);
    const data = await res.json();
    return data.reply || "The shadows are silent...";
  } catch(err) {
    console.error(err);
    return "The shadows are disturbed... try again later.";
  }
}

// Typing animation
function typeWriter(element, text, speed=40, callback){
  let i=0;
  const interval = setInterval(() => {
    element.textContent = text.slice(0,i+1) + (i < text.length-1 ? '|' : '');
    chatContainer.scrollTo({ top: chatContainer.scrollHeight, behavior: 'smooth' });
    i++;
    if(i===text.length){
      clearInterval(interval);
      element.textContent = text;
      if(callback) callback();
    }
  }, speed);
}

// Add message
function addMessage(sender, message, animateTyping=false){
  const msgDiv = document.createElement('div');
  msgDiv.className = `flex ${sender==='user'?'justify-end':'justify-start'} animate-fadeIn`;
  const bubble = document.createElement('div');
  bubble.className = 'rounded-xl p-4 max-w-xs md:max-w-md glass';
  const p = document.createElement('p'); 
  p.className='text-sm ' + (sender==='user' ? 'text-black dark:text-white' : 'text-black dark:text-white');
  bubble.appendChild(p); msgDiv.appendChild(bubble); chatContainer.appendChild(msgDiv);
  chatContainer.scrollTo({ top: chatContainer.scrollHeight, behavior: 'smooth' });
  if(animateTyping) typeWriter(p, message);
  else p.textContent = message;
}

// Send handler
async function sendMessage(){
  const message = userInput.value.trim();
  if(!message) return;
  addMessage('user', message);
  userInput.value='';

  const thinkingDiv = document.createElement('div');
  thinkingDiv.className='flex justify-start animate-fadeIn';
  thinkingDiv.innerHTML=`
    <div class="rounded-xl p-4 max-w-xs md:max-w-md glass flex gap-2">
      <div class="dot-flashing"></div>
    </div>
  `;
  chatContainer.appendChild(thinkingDiv);
  chatContainer.scrollTo({ top: chatContainer.scrollHeight, behavior: 'smooth' });

  await new Promise(r=>setTimeout(r,500)); // thinking delay
  const response = await queryAI(message);
  chatContainer.removeChild(thinkingDiv);
  addMessage('bot', response, true);
}

sendBtn.addEventListener('click', sendMessage);
userInput.addEventListener('keypress', e => { if(e.key==='Enter') sendMessage(); });
</script>
</body>
</html>
